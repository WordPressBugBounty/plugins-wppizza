jQuery(document).ready(function(d){var s,u,r=d(".wppizza-admin-orders"),n=d(".wppizza-admin-orders-attributes"),t=0<r.length,l=1e3*wppizza.aopt;t&&(s=function(){var e,t=r.attr("id").split("-").pop(-1),i=n.val(),o=JSON.parse(i),a=d("#wppizza_ajax_nonce").val();void 0!==o.audio_notify&&(e=new Audio(o.audio_notify)),r.prepend('<div class="wppizza-loading"></div>'),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-order-history",post_id:t,atts:i,nonce:a}},function(t){console.log("orders polling"),void 0!==t.notify&&e.play(),r.html(t.html)},"json").fail(function(t,e,i){alert("error[print] : "+i)})},u=setInterval(s,l),d(document).on("change",".wppizza-admin_orderhistory-order-status",function(t){clearInterval(u);var e=d(this),o=e.attr("id").split("-").pop(-1),a=e.val(),r=!1,n=o.split("_"),p=d("#wppizza_ajax_nonce").val();jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-change-status",uoKey:o,status:a,nonce:p}},function(t){return void 0!==t.update_prohibited?(alert(t.update_prohibited),void(r=!0)):(s(),void(void 0!==t.orderstatus_change_alert&&""!=t.orderstatus_change_alert&&alert(t.orderstatus_change_alert)))},"json").fail(function(t,e,i){alert("error[status] : "+i)}).done(function(){r||function(t,e,o,a,r){if(void 0!==t&&0<t.length)for(i=0;i<t.length;i++)new Function("self, blog_id, order_id, status","return "+t[i]+"(self, blog_id, order_id, status);")(e,o,a,r)}(wppizza.fnOrderStatusChange,e,n[0],n[1],a),u=setInterval(s,l)})}),d(document).on("click",".wppizza-order-print, .wppizza-order-view",function(t){var e=d(this),i=e.attr("id").split("-").pop(-1),o=!!e.hasClass("wppizza-order-print"),e=d("#wppizza_ajax_nonce").val();jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-view-order",uoKey:i,nonce:e}},function(t){var e,i=window.open("","WppizzaOrder","width="+t["window-width"]+",height="+t["window-height"]);null!=i&&void 0!==i?(i.document.open("text/html","replace"),"text/plain"==t["content-type"]?(e=t.markup.plaintext,i.document.write("<pre>"+e+"</pre>")):(e=t.markup.html,i.document.write(e)),i.focus(),o&&i.print()):alert("You must turn off your pop-up blocker to enable printing.\n\nPlease consult your device manufacturer about how to turn off pop-up blocking for this site.\n\n")},"json").fail(function(t,e,i){alert("error[view/print] : "+i)})}),d(document).on("click",".wppizza-order-delete",function(t){var e=d(this);if(!confirm(e.attr("title")+"?"))return!1;var i=e.attr("id").split("-").pop(-1),o=d("#wppizza_ajax_nonce").val();jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"admin-delete-order",uoKey:i,nonce:o}},function(t){void 0===t.update_prohibited?void 0!==t.success&&(e.closest("tr").empty().remove(),alert(t.success)):alert(t.update_prohibited)},"json").fail(function(t,e,i){alert("error[delete order] : "+i)})}))});